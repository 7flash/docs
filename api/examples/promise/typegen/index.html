<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<link rel="stylesheet" href="fonts/fonts.css"><title data-react-helmet="true">TS type generation | polkadot{.js}</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="TS type generation | polkadot{.js}"><meta data-react-helmet="true" name="description" content="This is a sample TypeScript project with full source &amp; config on GithHub, that uses @polkadot/typegen to generate type definitions that can be used to decorate the @polkadot/api. It uses both types defined for the specific chain as well as the chain metadata to generate TypeScript interfaces. This means that interfaces such as api.query., api.tx. and api.consts.* will be decorated based on chain-specific information, instead of an un-augmented catch-all definition."><meta data-react-helmet="true" property="og:description" content="This is a sample TypeScript project with full source &amp; config on GithHub, that uses @polkadot/typegen to generate type definitions that can be used to decorate the @polkadot/api. It uses both types defined for the specific chain as well as the chain metadata to generate TypeScript interfaces. This means that interfaces such as api.query., api.tx. and api.consts.* will be decorated based on chain-specific information, instead of an un-augmented catch-all definition."><meta data-react-helmet="true" property="og:url" content="https://polkadot.js.org/docs/api/examples/promise/typegen"><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://polkadot.js.org/docs/api/examples/promise/typegen"><link rel="stylesheet" href="/docs/styles.5cc6b0c0.css">
<link rel="preload" href="/docs/styles.2d0d11f0.js" as="script">
<link rel="preload" href="/docs/runtime~main.90bdee78.js" as="script">
<link rel="preload" href="/docs/main.e5e54110.js" as="script">
<link rel="preload" href="/docs/1.a1f0921d.js" as="script">
<link rel="preload" href="/docs/2.7569de93.js" as="script">
<link rel="preload" href="/docs/107.8f564fca.js" as="script">
<link rel="preload" href="/docs/935f2afb.1247ca9d.js" as="script">
<link rel="preload" href="/docs/17896441.ce33a7d3.js" as="script">
<link rel="preload" href="/docs/544296b2.d68c6875.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/docs/"><img class="navbar__logo" src="/docs/img/logo.svg" alt="polkadot{.js}"><strong class="navbar__title">polkadot{.js}</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://polkadot.js.org/apps/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Apps UI (Wallet)</a><a href="https://github.com/polkadot-js/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2_lZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_1NI3">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_1NI3">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs/"><img class="navbar__logo" src="/docs/img/logo.svg" alt="polkadot{.js}"><strong class="navbar__title">polkadot{.js}</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://polkadot.js.org/apps/" target="_blank" rel="noopener noreferrer" class="menu__link">Apps UI (Wallet)</a></li><li class="menu__list-item"><a href="https://github.com/polkadot-js/docs" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1BmH"><div class="docSidebarContainer_3DMU" role="complementary"><div class="sidebar_3sXx"><div class="menu menu--responsive menu_2n9V"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_3gxH" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/basics">Basics &amp; Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/create">Create an instance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.consts">Runtime constants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.query">State queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.rpc">RPC queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.query.subs">Query subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.query.multi">Multi queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.query.other">Query extras</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.tx">Transactions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/keyring">Keyring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.tx.subs">Transaction subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/api.tx.wrap">Complex transactions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/types.basics">Type basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/types.extend">Extending types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/rpc.custom">Custom RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/types.create">Type creation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/typescript">TypeScript interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/start/typescript.user">TypeScript user generated</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Cookbook</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook/blocks">Blocks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook/storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook/tx">Transactions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise">ApiPromise Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/simple-connect">Simple Connect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/listen-to-blocks">Listen to new blocks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/listen-to-balance-change">Listen to balance changes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/unsubscribe">Unsubscribe from listening to updates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/read-storage">Read storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/read-storage-at">Read storage, at a specific blockhash</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/make-transfer">Make a simple transfer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/system-events">Traverse events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/transfer-events">Transfer events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/examples/promise/upgrade-chain">Chain upgrade</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/api/examples/promise/typegen">TS type generation</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Substrate Metadata</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/rpc">JSON-RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/constants">Constants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/extrinsics">Extrinsics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/errors">Errors</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Keyring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/create">Create</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/ss58">ss58 Formats</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/sign-verify">Sign &amp; Verify</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/suri">Substrate Uri</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Crypto Utilities</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/create-mnemonic">Create Mnemonic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/validate-address">Validate Address</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/encrypt-decrypt">Encrypt &amp; Decrypt Messages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/create-multisig">Generate a Multisig Account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/verify-signature">Verify Signature</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contracts (API)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contracts">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/code">Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/blueprint">Blueprint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/contract">Contract</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Identicon (UI)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon/react">React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon/react-native">React Native</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon/vue">Vue</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Keyring (UI)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/init">Initialization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/accounts">Accounts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/addresses">Addresses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/loading">Loading saved pairs</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extension</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension/usage">Usage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension/cookbook">Cookbook</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2n1c"><div class="container padding-vert--lg docItemWrapper_262f"><div class="row"><div class="col docItemCol_1Cur"><div class="docItemContainer_3nIN"><article><header><h1 class="docTitle_Iv1f">TS type generation</h1></header><div class="markdown"><p>This is a sample TypeScript project <a href="https://github.com/polkadot-js/docs/tree/master/docs/api/examples/promise/typegen">with full source &amp; config on GithHub</a>, that uses <code>@polkadot/typegen</code> to generate type definitions that can be used to decorate the <code>@polkadot/api</code>. It uses both types defined for the specific chain as well as the chain metadata to generate TypeScript interfaces. This means that interfaces such as <code>api.query.*</code>, <code>api.tx.*</code> and <code>api.consts.*</code> will be decorated based on chain-specific information, instead of an un-augmented catch-all definition.</p><p><strong>NOTE</strong> This is built using the updates in the <code>1.4.0</code> api track and as such it uses the latest (at the time of writing) <code>@polkadot/api 1.4.0</code>. If you want to play on your own, it is also suggested that you use the <code>1.4+</code> series since some generation types have moved around internally, making it easier to augment.</p><h2 id="packages">Packages</h2><p>For the packages we need from the <code>@polkadot/*</code> we have added <code>@polkadot/api</code> (we want to do API stuff) and <code>@polkadot/typegen</code> (to generate the actual interfaces). So our scripts and dependencies inside <code>package.json</code> contain the following -</p><pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;yarn generate:defs &amp;&amp; yarn generate:meta&quot;,
    &quot;generate:defs&quot;: &quot;ts-node --skip-project node_modules/.bin/polkadot-types-from-defs --package sample-polkadotjs-typegen/interfaces --input ./src/interfaces&quot;,
    &quot;generate:meta&quot;: &quot;ts-node --skip-project node_modules/.bin/polkadot-types-from-chain --package sample-polkadotjs-typegen/interfaces --endpoint ./edgeware.json --output ./src/interfaces&quot;,
    &quot;lint&quot;: &quot;tsc --noEmit --pretty&quot;
  },
  &quot;dependencies&quot;: {
    &quot;@polkadot/api&quot;: &quot;^2.3.1&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;@polkadot/typegen&quot;: &quot;^2.3.1&quot;,
    &quot;ts-node&quot;: &quot;^8.6.2&quot;,
    &quot;typescript&quot;: &quot;^4.0.2&quot;
  }
}
</code></pre><p>We will delve into the setup and running the scripts and what they do in a short bit, but as of now just notice that we are running the scripts via <code>ts-node</code>. Since we supply our definitions as <code>*.ts</code> files, this is important otherwise they will not be parsable. <code>build</code> will just run both the types and meta generators (in that order, so metadata can use the types) and we have a <code>lint</code> that can just check that everything is as it is meant to be.</p><h2 id="metadata-setup">Metadata setup</h2><p>The idea here is to use the actual chain metadata to generate the actual api augmented endpoints. The metadata we are adding here (in addition to the user types), is from the Edgeware Berlin testnet. So this is a real-world example of configuring the API for a specific substrate chain. For the metadata retrieval, we just ran a simple curl command to get it from the node -</p><p><code>curl -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;id&quot;:&quot;1&quot;, &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;: &quot;state_getMetadata&quot;, &quot;params&quot;:[]}&#x27; http://localhost:9933</code></p><p>And then add the full JSONPC output as received to the <code>edgeware.json</code> file as specified by the generation command. A trimmed version would look like -</p><pre><code class="language-json">{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;result&quot;:&quot;0x6d6574610b6c185379737....&quot;,&quot;id&quot;:29}
</code></pre><p>The generator can also use a <code>wss://</code> as an <code>--endpoint</code> param as part of the generation, but in most cases you would want a static metadata to work from in development, hence we are actually adding it here.</p><h2 id="types-setup">Types setup</h2><p>The types are defined in the <code>src/interfaces</code> folder. While this repo contains a number of generated files in there as well, you basically only need to manually add the following -</p><ul><li><code>src/interfaces/definitions.ts</code> - this just exports all the sub-folder definitions in one go</li><li><code>src/interfaces/&lt;module&gt;/definitions.ts</code> - type definitions for a specific module</li></ul><p>This structure fully matches what is available in the <code>@polkadot/type/interfaces</code> folder, so the structure is setup based on the convention used in the <code>@polkadot/types</code> library. The generating scripts will expect something matching this since the same underlying code is actually used inside <code>@polkadot/types</code> as well. The top-level <code>interfaces/</code> folder can be name anything, however the internal content structure need to match what is defined above.</p><p>For the top-level the definition file has the following contents -</p><pre><code class="language-js">export { default as signaling } from &#x27;./signaling/definitions&#x27;;
export { default as treasuryRewards } from &#x27;./treasuryRewards/definitions&#x27;;
export { default as voting } from &#x27;./voting/definitions&#x27;;
</code></pre><p>As explained above, it really is just a re-export of the definitions, so they are all easily accessible to the outside, i.e. we will use this import inside our own code to use the definitions in API initialization. The generation scripts will load this file to determine which types it needs to import. By the <code>@polkadot/types</code> convention, match the export names with the folders (preferably your runtime module names), the generation scripts will use these names to find the correct folders to output the generated <code>types.ts</code> to.</p><p>For each of the folders, <code>signaling</code>, <code>treasuryRewards</code> and <code>voting</code> another <code>definitions.ts</code> file is contained within. Looking at the one from <code>signaling</code>, it contains this -</p><pre><code class="language-js">export default {
  types: {
    ProposalRecord: {
      index: &#x27;u32&#x27;,
      author: &#x27;AccountId&#x27;,
      stage: &#x27;VoteStage&#x27;,
      transition_time: &#x27;u32&#x27;,
      title: &#x27;Text&#x27;,
      contents: &#x27;Text&#x27;,
      vote_id: &#x27;u64&#x27;
    },
    ProposalContents: &#x27;Vec&lt;u8&gt;&#x27;,
    ProposalTitle: &#x27;Vec&lt;u8&gt;&#x27;
  }
}
</code></pre><p>Just the type definitions (the structure of which you should be familiar with), nested inside a <code>types: {...}</code> container. This allows us future extension points, i.e. there is some work to expose the custom RPC types alongside, so that would become another key on a per-module basis.</p><p>In the above, you will note that the <code>ProposalRecord</code> references a type for <code>voting</code>, i.e. <code>VoteStage</code>. The type generation and resolution will determine where the type comes from, and provide the required imports on generation.</p><p>Looking at the example in this repo, it also has <code>augment*</code>, <code>index.ts</code> and <code>types.ts</code> files in the interfaces folder. These are all generated, and will be re-generated when the generator is run - so all edits to these files will be lost. The only requirement for user-edits are the <code>definitions.ts</code> files.</p><h2 id="generating">Generating</h2><p>Now that both the metadata and types setup is completed, we just run the build command via <code>yarn build</code> and magically (assuming you didn&#x27;t have the <code>augment*</code> and other generated files), these files will be added. When running this command, the console should display something like -</p><pre><code>&gt; yarn build
$ yarn generate:defs &amp;&amp; yarn generate:meta
$ ts-node --skip-project \
  node_modules/.bin/polkadot-types-from-defs \
    --package sample-polkadotjs-typegen/interfaces \
    --input ./src/interfaces

sample-polkadotjs-typegen/src/interfaces/types.ts
    Generating
    Extracting interfaces for signaling
    ...
    Writing

sample-polkadotjs-typegen/src/interfaces/augment-types.ts
    Generating
    Writing

$ ts-node --skip-project \
  node_modules/.bin/polkadot-types-from-chain \
    --package sample-polkadotjs-typegen/interfaces \
    --endpoint ./edgeware.json \
    --output ./src/interfaces

Generating from metadata, 81,267 bytes
    ...

sample-polkadotjs-typegen/src/interfaces/augment-api.ts
    Generating
    Writing

âœ¨  Done in 4.04s.
</code></pre><p>Now if we check the actual output against the source via <code>yarn lint</code>, we would see that valid output has been generated -</p><pre><code>&gt; yarn lint
$ tsc --noEmit --pretty
âœ¨  Done in 2.28s.
</code></pre><h2 id="peering-at-the-output">Peering at the output</h2><p>We are ready to use all these generated types this after some TS config. If you take a look at the generated <code>src/signaling/types.ts</code>, you would see generated TS interfaces, such as -</p><pre><code class="language-js">import { Struct } from &#x27;@polkadot/types/codec&#x27;;
import { Bytes, Text, u32, u64 } from &#x27;@polkadot/types/primitive&#x27;;
import { AccountId } from &#x27;@polkadot/types/interfaces/runtime&#x27;;
import { VoteStage } from &#x27;sample-polkadotjs-typegen/interfaces/voting&#x27;;

/** @name ProposalContents */
export interface ProposalContents extends Bytes {}

/** @name ProposalRecord */
export interface ProposalRecord extends Struct {
  readonly index: u32;
  readonly author: AccountId;
  readonly stage: VoteStage;
  readonly transition_time: u32;
  readonly title: Text;
  readonly contents: Text;
  readonly vote_id: u64;
}

/** @name ProposalTitle */
export interface ProposalTitle extends Bytes {}
</code></pre><p>As mentioned earlier, here you will notice the <code>import { VoteStage }</code>, the generator has determined that <code>voting</code> exports that interface and has added the required imports.</p><h2 id="typescript-config">TypeScript config</h2><p>Now that we have files generated, it is time to make TypeScript aware of the types and add an explicit override into out <code>tsconfig.json</code>. After some changes, the paths in the config looks as follow (comments are in the actual config file here) -</p><pre><code class="language-json">{
  &quot;compilerOptions&quot;: {
    &quot;paths&quot;: {
      &quot;sample-polkadotjs-typegen/*&quot;: [&quot;src/*&quot;],
      &quot;@polkadot/api/augment&quot;: [&quot;src/interfaces/augment-api.ts&quot;],
      &quot;@polkadot/types/augment&quot;: [&quot;src/interfaces/augment-types.ts&quot;]
    }
  }
}
</code></pre><p>Effectively what we do above is tell the TypeScript compiler to not use the built-in API augmentation, but rather to replace it with our version. This means that all types from these are injected not by the substrate-latest-master version, but rather with what we have defined above.</p><h2 id="usage">Usage</h2><p>For simple usage, we have added the <code>src/index.ts</code> file that show how the metadata and types actually decorate the API. In addition, we also have setup instructions included here.</p><pre><code class="language-javascript">// We need to import the augmented definitions &quot;somewhere&quot; in our project, however since we have
// it in tsconfig as an override and the api/types has imports, it is not strictly required here.
// Because of the tsconfig override, we could import from &#x27;@polkadot/{api, types}/augment&#x27;
import &#x27;./interfaces/augment-api&#x27;;
import &#x27;./interfaces/augment-types&#x27;;

// all type stuff, the only one we are using here
import type { VoteRecord } from &#x27;./interfaces&#x27;;

// external imports
import { ApiPromise } from &#x27;@polkadot/api&#x27;;
import { createType } from &#x27;@polkadot/types&#x27;;

// our local stuff
import * as definitions from &#x27;./interfaces/definitions&#x27;;

async function main (): Promise&lt;void&gt; {
  // extract all types from definitions - fast and dirty approach, flatted on &#x27;types&#x27;
  const types = Object.values(definitions).reduce((res, { types }): object =&gt; ({ ...res, ...types }), {});

  const api = await ApiPromise.create({
    types: {
      ...types,
      // aliases that don&#x27;t do well as part of interfaces
      &#x27;voting::VoteType&#x27;: &#x27;VoteType&#x27;,
      &#x27;voting::TallyType&#x27;: &#x27;TallyType&#x27;,
      // chain-specific overrides
      Keys: &#x27;SessionKeys4&#x27;
    }
  });

  // get a query
  const recordOpt = await api.query.voting.voteRecords(123);

  // the types match with what we expect here
  let firstRecord: VoteRecord | null = recordOpt.unwrapOr(null);
  console.log(firstRecord?.toHuman());

  // it even does work for arrays &amp; subscriptions
  api.query.signaling.activeProposals((results): void =&gt; {
    results.forEach(([hash, blockNumber]): void =&gt; {
      console.log(hash.toHex(), &#x27;:&#x27;, blockNumber.toNumber());
    });
  });

  // even createType works, allowing for our types to be used
  console.log(`Balance2 bitLength:`, [
    api.createType(&#x27;Balance2&#x27;).bitLength(),
    api.registry.createType(&#x27;Balance2&#x27;).bitLength(),
    createType(api.registry, &#x27;Balance2&#x27;).bitLength()
  ]);
}

await main();
</code></pre><h2 id="and-that-is-a-">And that is a ...</h2><p>... wrap. Just a really simple walk-through to customizing the API TypeScript definitions for your chain.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/polkadot-js/docs/edit/master/docs/api/examples/promise/typegen.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/api/examples/promise/upgrade-chain"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Chain upgrade</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/api/FAQ"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">FAQ Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_1hW_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#packages" class="table-of-contents__link">Packages</a></li><li><a href="#metadata-setup" class="table-of-contents__link">Metadata setup</a></li><li><a href="#types-setup" class="table-of-contents__link">Types setup</a></li><li><a href="#generating" class="table-of-contents__link">Generating</a></li><li><a href="#peering-at-the-output" class="table-of-contents__link">Peering at the output</a></li><li><a href="#typescript-config" class="table-of-contents__link">TypeScript config</a></li><li><a href="#usage" class="table-of-contents__link">Usage</a></li><li><a href="#and-that-is-a-" class="table-of-contents__link">And that is a ...</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/docs/styles.2d0d11f0.js"></script>
<script src="/docs/runtime~main.90bdee78.js"></script>
<script src="/docs/main.e5e54110.js"></script>
<script src="/docs/1.a1f0921d.js"></script>
<script src="/docs/2.7569de93.js"></script>
<script src="/docs/107.8f564fca.js"></script>
<script src="/docs/935f2afb.1247ca9d.js"></script>
<script src="/docs/17896441.ce33a7d3.js"></script>
<script src="/docs/544296b2.d68c6875.js"></script>
</body>
</html>